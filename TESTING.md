# Quick Testing Guide - PreventIQ MVP

## ğŸš€ Quick Start Testing

### Prerequisites Check
- [x] Dev server running at http://localhost:8080
- [x] Supabase project configured
- [x] Environment variables loaded
- [x] Edge Functions deployed

## ğŸ§ª Test Scenarios

### Test 1: Landing Page Load âœ…
**Steps:**
1. Open http://localhost:8080 in browser
2. Observe page load

**Expected Results:**
- âœ… Navigation bar appears at top
- âœ… Hero section with CTAs visible
- âœ… All sections load without errors
- âœ… No console errors

---

### Test 2: Instant Value Widget ğŸ”„
**Steps:**
1. Scroll to "See the Power of AI Marketing" section
2. Click the dropdown and select "Diabetes Screening"
3. Click "Get 3 Free Subject Lines" button
4. Wait 2-3 seconds

**Expected Results:**
- âœ… Loading spinner appears
- âœ… 3 subject lines display in cards
- âœ… Each subject is under 52 characters
- âœ… Success toast notification appears
- âœ… Results cached in localStorage

**To Verify:**
```javascript
// Open browser console
localStorage.getItem('subjects_Diabetes Screening')
// Should return JSON with subjects array
```

**Edge Function to Check:**
- Function: `generate-subjects`
- Logs: Supabase Dashboard â†’ Edge Functions â†’ generate-subjects â†’ Logs

**Troubleshooting:**
- If fails: Check `LOVABLE_API_KEY` is set in Supabase secrets
- Error 429: Rate limit - wait a moment and retry
- Error 402: API credits exhausted

---

### Test 3: Lead Form Submission ğŸ”„
**Steps:**
1. Scroll to "Start a Free Pilot" section
2. Fill in the form:
   ```
   Name: Test User
   Email: test-<timestamp>@example.com
   Organization: Clinic
   Language: English
   City: Mumbai
   ```
3. Click "Start Free Pilot" button

**Expected Results:**
- âœ… Loading spinner on button
- âœ… Success toast: "Welcome to PreventIQ! Check your email..."
- âœ… Automatic redirect to `/thanks` page
- âœ… No error messages

**Database Verification:**
```sql
-- Run in Supabase SQL Editor
SELECT * FROM leads 
ORDER BY created_at DESC 
LIMIT 5;
```

**Expected Database Entry:**
```
id: <auto-generated>
name: "Test User"
email: "test-<timestamp>@example.com"
city: "Mumbai"
org_type: "Clinic"
lang: "en"
is_test: false
consent: true
created_at: <current timestamp>
```

**Edge Function to Check:**
- Function: `lead-intake`
- Logs: Supabase Dashboard â†’ Edge Functions â†’ lead-intake â†’ Logs

**Troubleshooting:**
- Duplicate email error: Use different email
- Form validation: Ensure all required fields filled
- Network error: Check Supabase URL in .env

---

### Test 4: Navigation Smooth Scroll ğŸ”„
**Steps:**
1. Click "How It Works" in navigation
2. Observe scroll behavior
3. Click "Features" in navigation
4. Click "Start Free Pilot" button

**Expected Results:**
- âœ… Smooth scroll to target section
- âœ… Section highlighted/visible
- âœ… Mobile menu closes on click (mobile only)

---

### Test 5: Mobile Responsiveness ğŸ”„
**Steps:**
1. Open browser DevTools (F12)
2. Toggle device toolbar (Ctrl+Shift+M)
3. Test various viewport sizes:
   - Mobile: 375px
   - Tablet: 768px
   - Desktop: 1920px

**Expected Results:**
- âœ… Navigation collapses to hamburger on mobile
- âœ… Sections stack properly
- âœ… Forms remain usable
- âœ… CTAs accessible on all sizes

---

## ğŸ” Database Inspection

### Check Personas (Archetypes)
```sql
SELECT * FROM personas WHERE is_archetype = true;
```

**Expected:** 6 rows:
- ARCH_PRO
- ARCH_TP
- ARCH_SEN
- ARCH_STU
- ARCH_RISK
- ARCH_PRICE

### Check Sync State
```sql
SELECT * FROM sync_state;
```

**Expected:** At least 1 row with source = 'email_events'

---

## ğŸ“Š Edge Function Testing

### Test generate-subjects directly
```bash
curl -X POST 'https://zdgvndxdhucbakguvkgw.supabase.co/functions/v1/generate-subjects' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_ANON_KEY' \
  -d '{"category":"Heart Health Checkup","lang":"en"}'
```

### Test lead-intake directly
```bash
curl -X POST 'https://zdgvndxdhucbakguvkgw.supabase.co/functions/v1/lead-intake' \
  -H 'Content-Type: application/json' \
  -H 'Authorization: Bearer YOUR_ANON_KEY' \
  -d '{
    "name":"API Test",
    "email":"apitest@example.com",
    "city":"Delhi",
    "org_type":"Hospital",
    "lang":"en"
  }'
```

---

## âœ… Success Checklist

After completing all tests, verify:

- [ ] Landing page loads completely
- [ ] Navigation works (desktop & mobile)
- [ ] Instant Value Widget generates subjects
- [ ] Lead form submits successfully
- [ ] Database stores lead correctly
- [ ] /thanks page displays after submission
- [ ] No console errors
- [ ] Mobile responsive
- [ ] Smooth scrolling works
- [ ] Toast notifications appear

---

## ğŸš¨ Common Issues & Fixes

### Issue: "Failed to generate subjects"
**Fix:**
1. Check Supabase Edge Functions logs
2. Verify LOVABLE_API_KEY is set: `supabase secrets list`
3. Check API quota in Lovable dashboard

### Issue: "Failed to submit lead"
**Fix:**
1. Check browser console for errors
2. Verify Supabase URL in .env
3. Check Edge Function logs for errors
4. Ensure database migrations ran successfully

### Issue: Duplicate email error
**Fix:**
- Use a unique email address
- Or delete test entries from database:
```sql
DELETE FROM leads WHERE email LIKE 'test%@example.com';
```

### Issue: CORS errors
**Fix:**
- Edge Functions should have CORS headers (already configured)
- Clear browser cache
- Check Edge Function code for corsHeaders

---

## ğŸ“ˆ Next Steps After Testing

1. **If all tests pass:**
   - Deploy to production (Lovable/Cloudflare)
   - Configure production environment variables
   - Test on production URL

2. **Set up n8n workflows:**
   - Flow C: Daily Send
   - Flow D: Event Sync
   - Flow E: Weekly Report

3. **Connect Brevo:**
   - Configure email templates
   - Test email delivery
   - Set up click tracking

4. **Monitor & Optimize:**
   - Check Edge Function logs daily
   - Monitor database size
   - Track API usage
   - Collect user feedback

---

## ğŸ¯ MVP Validation Criteria

- [x] Landing page is live and accessible
- [ ] Instant value widget works (AI generation)
- [ ] Lead capture works (form â†’ database)
- [ ] Database schema complete
- [ ] Edge Functions deployed
- [ ] No critical errors

**Target:** All tests passing âœ…

---

**Testing Date:** _____________  
**Tester:** _____________  
**Environment:** Development (localhost:8080)  
**Status:** Ready for Testing ğŸš€
